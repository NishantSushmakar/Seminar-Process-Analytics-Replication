SELECT "order"."id" AS "case_id", 'order' AS "activity_id", CAST("order"."creation_date" AS VARCHAR) AS "timestamp"
FROM "order"
UNION ALL
SELECT "order"."id" AS "case_id", 'order_line' AS "activity_id", CAST("order"."creation_date" AS VARCHAR) AS "timestamp"
FROM "order"
JOIN "order_line" ON "order"."id" = "order_line"."order"
UNION ALL
SELECT "order"."id" AS "case_id", 'shipment' AS "activity_id", CAST("shipment"."creation_date" AS VARCHAR) AS "timestamp"
FROM "shipment"
JOIN "order" ON "shipment"."customer" = "order"."customer"
UNION ALL
SELECT "order"."id" AS "case_id", 'shipment_line' AS "activity_id", CAST("shipment"."creation_date" AS VARCHAR) AS "timestamp"
FROM "shipment_line"
JOIN "shipment" ON "shipment_line"."shipment" = "shipment"."id"
JOIN "order_line" ON "shipment_line"."order_line" = "order_line"."id"
JOIN "order" ON "order_line"."order" = "order"."id"
UNION ALL
SELECT "order"."id" AS "case_id", 'invoice' AS "activity_id", CAST("invoice"."creation_date" AS VARCHAR) AS "timestamp"
FROM "invoice"
JOIN "order" ON "invoice"."customer" = "order"."customer"
UNION ALL
SELECT "order"."id" AS "case_id", 'payment' AS "activity_id", CAST("payment"."creation_date" AS VARCHAR) AS "timestamp"
FROM "payment"
JOIN "payment_line" ON "payment"."id" = "payment_line"."payment"
JOIN "invoice" ON "payment_line"."invoice" = "invoice"."id"
JOIN "element_relation" ON "invoice"."id" = "element_relation"."invoice"
JOIN "order" ON "element_relation"."order" = "order"."id"