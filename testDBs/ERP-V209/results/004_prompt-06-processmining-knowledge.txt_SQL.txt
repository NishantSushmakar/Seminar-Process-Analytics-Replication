SELECT DISTINCT "customer"."id" AS "case_id", 
                "activity_id", 
                CAST("timestamp" AS VARCHAR) AS "timestamp"
FROM (
    SELECT "customer"."id", 
           "invoice"."creation_date" AS "timestamp", 
           "invoice"."id" AS "activity_id"
    FROM "customer"
    JOIN "invoice" ON "customer"."id" = "invoice"."customer"
    UNION
    SELECT "customer"."id", 
           "order"."creation_date" AS "timestamp", 
           "order"."id" AS "activity_id"
    FROM "customer"
    JOIN "order" ON "customer"."id" = "order"."customer"
) AS events;